apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: preview-d478c60-vs
  namespace: previews
spec:
  hosts:
    - "preview-d478c60.slingshotgrp.com"
  gateways:
    - default/nextjsportfolio-gateway
  http:
    # Route API calls to backend services
    - match:
        - uri:
            prefix: /api/upload
      route:
        - destination:
            host: upload-service-d478c60.previews.svc.cluster.local
            port:
              number: 80
    - match:
        - uri:
            prefix: /api/processor
      route:
        - destination:
            host: processor-service-d478c60.previews.svc.cluster.local
            port:
              number: 80
    - match:
        - uri:
            prefix: /api/analyze
      route:
        - destination:
            host: ai-analyzer-service-d478c60.previews.svc.cluster.local
            port:
              number: 80
    # Default route to web frontend
    - route:
        - destination:
            host: web-d478c60.previews.svc.cluster.local
            port:
              number: 80
